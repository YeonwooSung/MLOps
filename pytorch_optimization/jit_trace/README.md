# torch.jit

## 1. torch.jit.trace()와 torch.no_grad() 관련 실험

우선, torch.jit.trace()를 통해 TorchScript 모듈로 변환한 후, no_grad() 포함해서 inference한 버전과 없이 inference를 한 버전의 아웃풋을 비교해 보았다.

먼저 no_grad 없이 해본 결과이다:

```python
traced_model = torch.jit.trace(model, [tokens_tensor, segments_tensors])
output = traced_model(tokens_tensor, segments_tensors)
print(output)

# Output:
(tensor([[[-2.5689e-01, -7.3601e-03, -8.9146e-02,  ..., -1.3546e-01,
           2.3597e-01,  2.4208e-01],
         [-5.8262e-01,  3.1923e-01, -2.8020e-01,  ...,  1.0413e-01,
           1.7953e-01, -4.7086e-01],
         [-3.0671e-01, -2.3213e-01, -1.5938e-01,  ...,  7.0992e-02,
           1.4761e-01,  2.7529e-01],
         ...,
         [ 2.0549e-01, -1.6317e-02, -7.1084e-05,  ..., -1.3032e-01,
           6.1008e-01,  4.2999e-01],
         [-4.9530e-01, -4.6195e-01, -2.9027e-01,  ...,  6.3559e-01,
           6.2100e-01,  1.0318e-01],
         [ 8.2051e-01,  1.8250e-01, -1.1302e-01,  ...,  1.5103e-01,
          -7.6513e-01, -1.9481e-02]]], grad_fn=<NativeLayerNormBackward0>), tensor([[-4.9859e-01, -1.6913e-01,  8.3044e-01,  7.2490e-02, -4.8807e-01,
         -9.1259e-02,  5.1964e-01,  1.2615e-01,  7.3988e-01, -9.9609e-01,
          3.7945e-01, -5.8106e-01,  9.5275e-01, -6.8154e-01,  7.0220e-01,
         -2.4374e-01,  9.2702e-02, -3.1205e-01,  2.3801e-01, -3.3289e-01,
          2.2093e-01, -3.1050e-01,  7.1334e-01,  6.8511e-02,  1.5540e-01,
         -7.6150e-01, -2.8993e-01,  7.5329e-01,  8.3335e-01,  5.7146e-01,
         -3.3142e-01,  1.4806e-01, -9.5029e-01, -9.6337e-02,  7.7407e-01,
         -9.3747e-01, -3.0847e-02, -4.7886e-01,  4.4816e-02,  1.1357e-02,
         -6.1463e-01,  2.0118e-01,  9.0852e-01, -6.6917e-01, -3.0572e-01,
         -2.4733e-01, -6.9975e-01,  9.1703e-02, -6.5932e-01, -8.4444e-01,
         -7.1574e-01, -8.7206e-01,  5.5364e-02,  1.0259e-01,  2.0758e-01,
          4.1869e-01, -2.2090e-01,  6.6650e-02,  3.9337e-02, -3.4385e-01,
         -4.0217e-01,  3.1609e-02,  6.8003e-01, -7.3265e-01, -7.0735e-01,
         -8.4914e-01, -3.4449e-02, -7.7896e-02,  1.1542e-01, -5.8604e-02,
          5.3955e-01,  7.7160e-02,  4.1768e-01, -4.7927e-01, -7.7228e-01,
          1.0024e-01, -1.9495e-01,  9.0035e-01,  2.1756e-01, -9.3141e-01,
         -6.6439e-01, -6.5286e-01,  1.0850e-01,  8.2425e-01, -8.0041e-01,
         -8.0010e-01,  1.9082e-01, -8.2846e-03, -9.5559e-01,  1.0529e-01,
          4.8709e-02, -2.7277e-02, -7.0070e-01,  1.2284e-01,  1.0367e-01,
          1.1624e-01, -3.6921e-02,  6.1928e-01,  3.4673e-02,  2.5419e-01,
         -1.0259e-01,  5.9038e-03,  2.2802e-01, -1.5938e-01, -9.4064e-02,
         -1.3483e-01,  9.1638e-02, -2.5277e-01, -4.0633e-01,  3.5905e-01,
          1.7583e-01, -5.4669e-02, -3.7656e-02, -8.2613e-01,  3.9060e-01,
         -7.5958e-02, -9.2011e-01, -1.5846e-01, -9.5379e-01,  4.7328e-01,
          2.2438e-01, -4.0782e-02,  8.4882e-01,  7.4372e-01,  6.8334e-02,
          1.2067e-01,  8.3558e-01, -9.3571e-01,  2.5638e-01,  2.7365e-01,
          5.1111e-01,  2.4958e-03, -9.1422e-01, -8.5609e-01,  2.6730e-01,
          8.2105e-01, -1.9208e-02,  9.0641e-01,  3.1729e-02,  8.1417e-01,
          5.3713e-01,  1.5256e-01, -6.5996e-01, -2.9205e-01, -2.6196e-01,
         -6.0163e-02, -1.6913e-01,  1.9751e-01,  4.2851e-01, -5.6606e-01,
          3.2405e-01, -1.4614e-01,  7.3622e-01, -7.3622e-01, -3.0769e-01,
          7.5544e-01,  5.2388e-01,  8.3670e-01,  7.7317e-01,  2.1111e-02,
         -1.0186e-01,  5.3786e-01, -1.1288e-01,  1.2010e-01,  2.8660e-01,
          1.5836e-01, -5.5910e-01,  1.3677e-01, -6.5858e-01,  4.6724e-01,
          1.8676e-01, -7.8810e-04,  8.0405e-01, -9.3026e-01, -6.9134e-02,
          2.2026e-01,  9.3376e-01,  4.8834e-01,  6.0626e-02, -5.2468e-01,
         -6.7205e-02, -2.8043e-01, -8.0448e-01,  9.1711e-01,  3.1231e-02,
          1.4967e-01,  5.4755e-01, -5.2422e-01, -6.1328e-01, -6.5674e-01,
          5.5004e-01,  3.5562e-01, -6.2681e-01,  1.7565e-01, -2.6099e-01,
         -1.2162e-01,  5.5805e-01,  1.7059e-01, -7.8489e-02, -2.6815e-01,
          1.2040e-01,  7.8531e-01,  6.7986e-01,  4.0405e-01, -7.0169e-01,
          1.0016e-01, -6.9205e-01,  3.5772e-02,  7.4413e-02,  1.4686e-01,
         -4.7862e-02,  9.5771e-01,  2.1660e-01,  6.9753e-04, -6.7157e-01,
         -9.2958e-01,  1.2179e-02, -6.3569e-01,  1.3246e-01, -3.6443e-01,
         -1.9593e-01,  6.1201e-01, -5.9816e-01,  7.9575e-02, -7.0562e-01,
         -5.6153e-01,  9.3639e-02, -1.2182e-01,  1.3971e-01, -5.4726e-02,
          3.1027e-01, -7.9235e-01, -2.9843e-01,  3.6523e-01,  7.2965e-01,
          8.2288e-01, -4.8346e-01,  3.6060e-01, -1.5700e-02,  6.6516e-01,
         -3.1768e-01,  8.6993e-01, -6.7448e-01, -7.0250e-02, -7.9002e-01,
          5.6488e-01, -6.6356e-01,  6.4933e-01, -4.8080e-03, -8.2526e-01,
         -6.7866e-01,  1.6267e-01,  5.3347e-02,  8.8357e-01, -7.1264e-02,
          8.2370e-01, -5.7167e-01, -8.5698e-01, -1.2295e-01,  2.3306e-01,
         -9.4883e-01, -6.4056e-01,  9.9413e-02, -6.6189e-01, -1.6533e-01,
          7.5127e-03, -8.3298e-01,  4.5723e-01,  8.1019e-02,  8.3341e-01,
          2.2406e-01, -5.3090e-01,  1.4762e-01, -7.6026e-01, -1.6274e-01,
          1.3930e-01,  8.2007e-01, -9.1361e-02, -8.5741e-01,  2.0810e-01,
          2.9116e-01,  1.5543e-01,  8.5719e-01,  8.7265e-01,  6.3798e-01,
          9.2237e-01,  7.0844e-01,  4.0798e-01,  3.7541e-01,  8.2557e-02,
          9.9737e-01,  6.1868e-01, -7.9913e-01, -8.2941e-01, -2.8434e-01,
          1.2858e-01, -9.2797e-01, -6.3592e-02,  4.6552e-02, -8.1194e-01,
         -7.1708e-01,  9.1365e-01,  7.2862e-01, -8.9509e-01,  7.3806e-01,
          7.2612e-01, -2.3452e-01, -6.6035e-01,  6.3779e-02,  9.3092e-01,
          1.6668e-02,  3.3495e-01, -1.8453e-02,  1.5112e-01,  4.9735e-01,
         -5.7902e-01,  6.5534e-01,  6.6720e-01, -6.5395e-01, -8.4178e-02,
         -1.6271e-01, -7.9912e-01, -3.1524e-01,  1.7051e-03, -3.4439e-01,
         -8.4678e-01, -2.0301e-02, -5.9327e-01,  1.5047e-01, -4.0944e-03,
          1.0241e-03, -5.2182e-01,  4.0745e-02, -8.2124e-01,  1.3655e-01,
          3.0421e-01, -7.6729e-01, -1.4364e-01,  3.7359e-01, -5.8641e-01,
          6.7145e-01, -8.4058e-01,  8.8928e-01, -4.8594e-02, -7.0527e-01,
          9.0982e-01, -1.3674e-01, -6.2551e-01, -1.2153e-01, -5.7317e-02,
          1.6933e-01,  8.5137e-01, -3.0268e-01, -9.2407e-01, -1.4311e-01,
         -2.2600e-01, -4.9942e-02,  7.3210e-02,  9.7865e-01,  3.2855e-02,
          6.2553e-01,  6.3310e-01,  9.3339e-01, -9.5555e-01, -6.6198e-01,
         -6.5063e-01, -8.4128e-01,  8.7723e-01,  7.9893e-01,  1.4459e-01,
         -1.9865e-01, -6.9513e-02,  6.3042e-01, -1.2870e-02, -7.2304e-01,
          2.7195e-01,  2.2727e-01, -2.9498e-02,  7.1309e-01, -4.8478e-01,
         -1.1718e-01,  2.0216e-01,  4.6508e-01,  4.6507e-01, -7.6713e-01,
          2.0409e-01, -5.9565e-03, -8.2280e-02, -8.4956e-02, -1.4858e-01,
         -8.5327e-01, -3.6672e-01,  8.7005e-01,  1.9555e-01, -6.6828e-01,
          1.5964e-01, -1.6004e-02, -3.9608e-01,  1.0805e-01,  9.5431e-02,
         -8.3893e-02, -5.9011e-01, -6.5418e-01, -5.9851e-01, -9.5626e-01,
          2.0579e-01,  2.3757e-02, -3.0543e-02,  5.7845e-01,  1.2862e-01,
         -8.2295e-03, -2.6664e-01, -6.8082e-01, -9.6271e-02,  6.9126e-02,
         -8.6602e-01,  8.7522e-01, -1.0679e-01,  1.2648e-01,  3.2427e-01,
          7.7688e-01, -9.3565e-02, -3.4144e-01, -4.7952e-02, -7.3323e-01,
          1.4223e-01, -8.2471e-01,  8.3261e-01, -8.1426e-01,  7.6197e-02,
         -5.7766e-02, -4.5483e-01,  9.0928e-01, -1.8027e-01,  2.0544e-01,
         -1.8068e-01,  4.2399e-01,  3.3363e-01, -2.0288e-01, -2.2413e-01,
          3.6761e-02,  8.0875e-01, -1.0995e-03,  3.5741e-02, -9.0296e-01,
         -7.9219e-01, -5.2211e-01, -6.7589e-01, -9.5255e-01,  7.0411e-01,
          2.6826e-01,  4.0883e-02,  5.4808e-01, -2.2253e-01, -2.8980e-01,
         -8.3246e-02,  1.0494e-01, -8.2818e-01,  7.8696e-01, -1.0552e-01,
          2.0068e-01, -1.1545e-01,  2.2196e-01, -8.5198e-01,  8.6098e-01,
          7.5903e-01,  2.5622e-01, -8.8536e-03, -4.7662e-01,  3.9720e-01,
         -3.4306e-01,  8.0380e-01, -7.8320e-02,  8.9613e-01, -1.4736e-01,
         -7.5046e-01,  3.7599e-01,  2.0120e-01,  6.4580e-02,  4.4332e-02,
         -8.3205e-01,  3.1302e-03,  7.8753e-01,  7.9850e-01, -4.4507e-01,
         -5.6260e-03, -3.3181e-02, -5.8860e-01, -7.9499e-01,  4.4164e-01,
         -3.1938e-01, -3.7808e-02,  6.6738e-02,  1.9533e-02,  8.4942e-01,
          5.3235e-03,  9.4798e-02, -1.2333e-01,  8.5869e-02, -1.0280e-01,
         -1.2946e-01,  8.5376e-01,  1.8801e-01, -3.2741e-01, -9.6287e-01,
          6.1638e-01, -6.9420e-01,  4.4450e-01,  6.0681e-01, -6.6629e-01,
          5.0974e-02,  3.4253e-02, -1.8121e-01,  2.2566e-01, -1.4444e-02,
         -1.3434e-01,  4.3035e-02,  1.1194e-01,  9.0154e-01, -2.0848e-01,
         -8.8703e-01, -3.1255e-01,  6.9419e-02, -8.3545e-01, -2.6751e-01,
         -2.3816e-01,  2.7348e-03, -1.5042e-01,  4.7942e-01,  3.3011e-01,
         -1.6503e-01, -9.0385e-01, -6.1607e-02, -1.1797e-01,  9.0846e-01,
          2.6326e-02, -1.3698e-01, -6.5338e-01, -7.4803e-01, -4.6147e-01,
          8.1519e-01, -8.4302e-01,  9.1290e-01, -8.3432e-01,  3.5692e-03,
          7.8573e-01,  2.6059e-01, -7.7205e-01, -3.1327e-03, -6.6097e-02,
          5.1946e-02,  3.9750e-01,  1.4424e-01, -8.5038e-01, -1.8162e-02,
         -1.0716e-02,  1.1313e-01,  8.5687e-04,  3.9124e-01,  4.4546e-01,
          9.0402e-02, -1.6985e-01, -3.3805e-01,  6.1812e-02,  2.2982e-01,
          2.3385e-01, -1.2379e-01,  4.5419e-02,  5.1026e-02, -7.1863e-04,
         -6.6718e-01, -1.3307e-01,  7.8950e-02, -2.0892e-02,  3.0005e-01,
         -9.1189e-01, -6.5355e-01, -7.6801e-01, -9.3507e-02,  5.3021e-01,
          2.1915e-02, -4.8867e-01, -3.5073e-01,  8.0068e-01,  8.4983e-01,
          3.5458e-01,  2.0711e-02,  5.9287e-01, -3.4995e-01, -7.2958e-02,
          3.9693e-02,  7.5798e-02,  6.1057e-01,  4.2597e-01, -2.0743e-02,
          9.1923e-01, -5.0432e-03,  5.8217e-02, -6.0209e-01,  1.3403e-01,
         -7.2889e-02,  6.6255e-01, -4.6876e-01, -8.6120e-01,  1.0894e-02,
          1.8972e-02, -4.4184e-01,  2.5289e-02, -1.1211e-01, -3.0922e-01,
          6.5002e-01,  7.4250e-01,  5.5601e-01, -1.8821e-01,  1.3612e-01,
         -9.7374e-02, -4.0479e-02, -2.4442e-02, -7.8018e-01,  9.5698e-01,
          1.7359e-01,  4.7505e-01,  3.3328e-01,  2.2359e-01,  8.7758e-01,
          1.3941e-02,  3.2011e-01, -1.0929e-02,  7.9241e-01,  6.8530e-02,
         -7.1604e-01,  5.0206e-01, -9.1000e-01, -3.8872e-02, -7.6048e-01,
          1.7364e-01, -1.7590e-01,  5.9545e-01, -1.0509e-01,  8.5677e-01,
          8.0183e-01, -1.7133e-02,  4.1293e-01,  8.1418e-01,  1.5888e-01,
         -7.5477e-01, -9.5126e-01, -9.6628e-01, -7.2032e-02, -2.3228e-01,
          4.7854e-02,  1.7156e-01, -2.8391e-02,  1.4297e-01,  3.4419e-02,
         -8.3534e-01,  7.9761e-01,  1.2672e-01, -8.1043e-01,  8.8525e-01,
         -3.8777e-01,  6.0806e-02,  2.3121e-01, -9.4670e-01, -5.4725e-01,
         -1.0510e-01, -1.3351e-01,  3.5533e-01,  1.4217e-01,  5.4140e-01,
          1.9415e-02, -3.2170e-01, -6.5439e-02,  7.8295e-01, -5.2289e-01,
         -9.5798e-01,  2.8194e-01,  6.3611e-01, -5.6436e-01,  8.3533e-01,
         -6.4246e-01, -1.0839e-01,  7.5424e-01,  7.2921e-01,  5.5158e-01,
          4.3062e-01,  2.0447e-01,  1.1434e-01,  3.8707e-01,  6.9555e-01,
          7.4856e-01,  9.5958e-01,  6.6706e-01,  2.7684e-01,  7.0061e-01,
          2.4441e-02,  4.2779e-01, -8.4437e-01, -5.7102e-02, -4.4115e-01,
          2.1374e-01,  1.0470e-01, -4.6251e-02, -6.4018e-01,  4.0994e-01,
          7.6299e-02,  1.8739e-01, -8.4008e-02,  2.8767e-01, -2.4358e-01,
          1.1020e-02, -5.1402e-01,  4.9222e-02,  2.6653e-01, -5.8301e-02,
          7.9280e-01, -2.4956e-01, -7.8913e-03, -1.1233e-01,  5.1617e-02,
          7.6497e-01, -8.3232e-01,  5.1334e-01,  5.9827e-02,  8.3035e-01,
         -5.8532e-01, -2.4030e-01,  6.1904e-01, -3.5076e-01, -1.3420e-01,
         -8.9157e-02, -4.9536e-01,  4.9910e-01, -4.5500e-02, -1.6105e-01,
         -3.7617e-02,  3.7182e-01,  1.6940e-01, -1.1236e-01,  5.3460e-01,
          7.2991e-01,  1.8875e-01,  4.1904e-02,  1.7980e-01,  6.0190e-02,
         -7.9329e-01,  1.4009e-01,  6.1139e-01, -6.1764e-01,  3.4262e-01,
         -6.7680e-01,  4.8117e-01, -7.8062e-01,  4.0878e-02, -3.7002e-01,
         -6.8798e-01, -3.8813e-01,  1.6272e-01,  1.2418e-01,  7.1285e-01,
         -7.0520e-01,  6.1055e-01,  3.9583e-01,  7.1228e-01,  1.4088e-01,
          5.9301e-01, -3.6854e-01,  5.7186e-01]], grad_fn=<TanhBackward0>))
```

결과가 보여주듯이, 아웃풋에 backward 관련 내용이 포함되어 있다.

다음은 no_grad을 사용한 결과이다:

```python
traced_model = torch.jit.trace(model, [tokens_tensor, segments_tensors])

with torch.no_grad():
    output = traced_model(tokens_tensor, segments_tensors)
print(output)

# Output:
(tensor([[[-2.5689e-01, -7.3601e-03, -8.9146e-02,  ..., -1.3546e-01,
           2.3597e-01,  2.4208e-01],
         [-5.8262e-01,  3.1923e-01, -2.8020e-01,  ...,  1.0413e-01,
           1.7953e-01, -4.7086e-01],
         [-3.0671e-01, -2.3213e-01, -1.5938e-01,  ...,  7.0992e-02,
           1.4761e-01,  2.7529e-01],
         ...,
         [ 2.0549e-01, -1.6317e-02, -7.1084e-05,  ..., -1.3032e-01,
           6.1008e-01,  4.2999e-01],
         [-4.9530e-01, -4.6195e-01, -2.9027e-01,  ...,  6.3559e-01,
           6.2100e-01,  1.0318e-01],
         [ 8.2051e-01,  1.8250e-01, -1.1302e-01,  ...,  1.5103e-01,
          -7.6513e-01, -1.9481e-02]]]), tensor([[-4.9859e-01, -1.6913e-01,  8.3044e-01,  7.2490e-02, -4.8807e-01,
         -9.1259e-02,  5.1964e-01,  1.2615e-01,  7.3988e-01, -9.9609e-01,
          3.7945e-01, -5.8106e-01,  9.5275e-01, -6.8154e-01,  7.0220e-01,
         -2.4374e-01,  9.2702e-02, -3.1205e-01,  2.3801e-01, -3.3289e-01,
          2.2093e-01, -3.1050e-01,  7.1334e-01,  6.8511e-02,  1.5540e-01,
         -7.6150e-01, -2.8993e-01,  7.5329e-01,  8.3335e-01,  5.7146e-01,
         -3.3142e-01,  1.4806e-01, -9.5029e-01, -9.6337e-02,  7.7407e-01,
         -9.3747e-01, -3.0847e-02, -4.7886e-01,  4.4816e-02,  1.1357e-02,
         -6.1463e-01,  2.0118e-01,  9.0852e-01, -6.6917e-01, -3.0572e-01,
         -2.4733e-01, -6.9975e-01,  9.1703e-02, -6.5932e-01, -8.4444e-01,
         -7.1574e-01, -8.7206e-01,  5.5364e-02,  1.0259e-01,  2.0758e-01,
          4.1869e-01, -2.2090e-01,  6.6650e-02,  3.9337e-02, -3.4385e-01,
         -4.0217e-01,  3.1609e-02,  6.8003e-01, -7.3265e-01, -7.0735e-01,
         -8.4914e-01, -3.4449e-02, -7.7896e-02,  1.1542e-01, -5.8604e-02,
          5.3955e-01,  7.7160e-02,  4.1768e-01, -4.7927e-01, -7.7228e-01,
          1.0024e-01, -1.9495e-01,  9.0035e-01,  2.1756e-01, -9.3141e-01,
         -6.6439e-01, -6.5286e-01,  1.0850e-01,  8.2425e-01, -8.0041e-01,
         -8.0010e-01,  1.9082e-01, -8.2846e-03, -9.5559e-01,  1.0529e-01,
          4.8709e-02, -2.7277e-02, -7.0070e-01,  1.2284e-01,  1.0367e-01,
          1.1624e-01, -3.6921e-02,  6.1928e-01,  3.4673e-02,  2.5419e-01,
         -1.0259e-01,  5.9038e-03,  2.2802e-01, -1.5938e-01, -9.4064e-02,
         -1.3483e-01,  9.1638e-02, -2.5277e-01, -4.0633e-01,  3.5905e-01,
          1.7583e-01, -5.4669e-02, -3.7656e-02, -8.2613e-01,  3.9060e-01,
         -7.5958e-02, -9.2011e-01, -1.5846e-01, -9.5379e-01,  4.7328e-01,
          2.2438e-01, -4.0782e-02,  8.4882e-01,  7.4372e-01,  6.8334e-02,
          1.2067e-01,  8.3558e-01, -9.3571e-01,  2.5638e-01,  2.7365e-01,
          5.1111e-01,  2.4958e-03, -9.1422e-01, -8.5609e-01,  2.6730e-01,
          8.2105e-01, -1.9208e-02,  9.0641e-01,  3.1729e-02,  8.1417e-01,
          5.3713e-01,  1.5256e-01, -6.5996e-01, -2.9205e-01, -2.6196e-01,
         -6.0163e-02, -1.6913e-01,  1.9751e-01,  4.2851e-01, -5.6606e-01,
          3.2405e-01, -1.4614e-01,  7.3622e-01, -7.3622e-01, -3.0769e-01,
          7.5544e-01,  5.2388e-01,  8.3670e-01,  7.7317e-01,  2.1111e-02,
         -1.0186e-01,  5.3786e-01, -1.1288e-01,  1.2010e-01,  2.8660e-01,
          1.5836e-01, -5.5910e-01,  1.3677e-01, -6.5858e-01,  4.6724e-01,
          1.8676e-01, -7.8810e-04,  8.0405e-01, -9.3026e-01, -6.9134e-02,
          2.2026e-01,  9.3376e-01,  4.8834e-01,  6.0626e-02, -5.2468e-01,
         -6.7205e-02, -2.8043e-01, -8.0448e-01,  9.1711e-01,  3.1231e-02,
          1.4967e-01,  5.4755e-01, -5.2422e-01, -6.1328e-01, -6.5674e-01,
          5.5004e-01,  3.5562e-01, -6.2681e-01,  1.7565e-01, -2.6099e-01,
         -1.2162e-01,  5.5805e-01,  1.7059e-01, -7.8489e-02, -2.6815e-01,
          1.2040e-01,  7.8531e-01,  6.7986e-01,  4.0405e-01, -7.0169e-01,
          1.0016e-01, -6.9205e-01,  3.5772e-02,  7.4413e-02,  1.4686e-01,
         -4.7862e-02,  9.5771e-01,  2.1660e-01,  6.9753e-04, -6.7157e-01,
         -9.2958e-01,  1.2179e-02, -6.3569e-01,  1.3246e-01, -3.6443e-01,
         -1.9593e-01,  6.1201e-01, -5.9816e-01,  7.9575e-02, -7.0562e-01,
         -5.6153e-01,  9.3639e-02, -1.2182e-01,  1.3971e-01, -5.4726e-02,
          3.1027e-01, -7.9235e-01, -2.9843e-01,  3.6523e-01,  7.2965e-01,
          8.2288e-01, -4.8346e-01,  3.6060e-01, -1.5700e-02,  6.6516e-01,
         -3.1768e-01,  8.6993e-01, -6.7448e-01, -7.0250e-02, -7.9002e-01,
          5.6488e-01, -6.6356e-01,  6.4933e-01, -4.8080e-03, -8.2526e-01,
         -6.7866e-01,  1.6267e-01,  5.3347e-02,  8.8357e-01, -7.1264e-02,
          8.2370e-01, -5.7167e-01, -8.5698e-01, -1.2295e-01,  2.3306e-01,
         -9.4883e-01, -6.4056e-01,  9.9413e-02, -6.6189e-01, -1.6533e-01,
          7.5127e-03, -8.3298e-01,  4.5723e-01,  8.1019e-02,  8.3341e-01,
          2.2406e-01, -5.3090e-01,  1.4762e-01, -7.6026e-01, -1.6274e-01,
          1.3930e-01,  8.2007e-01, -9.1361e-02, -8.5741e-01,  2.0810e-01,
          2.9116e-01,  1.5543e-01,  8.5719e-01,  8.7265e-01,  6.3798e-01,
          9.2237e-01,  7.0844e-01,  4.0798e-01,  3.7541e-01,  8.2557e-02,
          9.9737e-01,  6.1868e-01, -7.9913e-01, -8.2941e-01, -2.8434e-01,
          1.2858e-01, -9.2797e-01, -6.3592e-02,  4.6552e-02, -8.1194e-01,
         -7.1708e-01,  9.1365e-01,  7.2862e-01, -8.9509e-01,  7.3806e-01,
          7.2612e-01, -2.3452e-01, -6.6035e-01,  6.3779e-02,  9.3092e-01,
          1.6668e-02,  3.3495e-01, -1.8453e-02,  1.5112e-01,  4.9735e-01,
         -5.7902e-01,  6.5534e-01,  6.6720e-01, -6.5395e-01, -8.4178e-02,
         -1.6271e-01, -7.9912e-01, -3.1524e-01,  1.7051e-03, -3.4439e-01,
         -8.4678e-01, -2.0301e-02, -5.9327e-01,  1.5047e-01, -4.0944e-03,
          1.0241e-03, -5.2182e-01,  4.0745e-02, -8.2124e-01,  1.3655e-01,
          3.0421e-01, -7.6729e-01, -1.4364e-01,  3.7359e-01, -5.8641e-01,
          6.7145e-01, -8.4058e-01,  8.8928e-01, -4.8594e-02, -7.0527e-01,
          9.0982e-01, -1.3674e-01, -6.2551e-01, -1.2153e-01, -5.7317e-02,
          1.6933e-01,  8.5137e-01, -3.0268e-01, -9.2407e-01, -1.4311e-01,
         -2.2600e-01, -4.9942e-02,  7.3210e-02,  9.7865e-01,  3.2855e-02,
          6.2553e-01,  6.3310e-01,  9.3339e-01, -9.5555e-01, -6.6198e-01,
         -6.5063e-01, -8.4128e-01,  8.7723e-01,  7.9893e-01,  1.4459e-01,
         -1.9865e-01, -6.9513e-02,  6.3042e-01, -1.2870e-02, -7.2304e-01,
          2.7195e-01,  2.2727e-01, -2.9498e-02,  7.1309e-01, -4.8478e-01,
         -1.1718e-01,  2.0216e-01,  4.6508e-01,  4.6507e-01, -7.6713e-01,
          2.0409e-01, -5.9565e-03, -8.2280e-02, -8.4956e-02, -1.4858e-01,
         -8.5327e-01, -3.6672e-01,  8.7005e-01,  1.9555e-01, -6.6828e-01,
          1.5964e-01, -1.6004e-02, -3.9608e-01,  1.0805e-01,  9.5431e-02,
         -8.3893e-02, -5.9011e-01, -6.5418e-01, -5.9851e-01, -9.5626e-01,
          2.0579e-01,  2.3757e-02, -3.0543e-02,  5.7845e-01,  1.2862e-01,
         -8.2295e-03, -2.6664e-01, -6.8082e-01, -9.6271e-02,  6.9126e-02,
         -8.6602e-01,  8.7522e-01, -1.0679e-01,  1.2648e-01,  3.2427e-01,
          7.7688e-01, -9.3565e-02, -3.4144e-01, -4.7952e-02, -7.3323e-01,
          1.4223e-01, -8.2471e-01,  8.3261e-01, -8.1426e-01,  7.6197e-02,
         -5.7766e-02, -4.5483e-01,  9.0928e-01, -1.8027e-01,  2.0544e-01,
         -1.8068e-01,  4.2399e-01,  3.3363e-01, -2.0288e-01, -2.2413e-01,
          3.6761e-02,  8.0875e-01, -1.0995e-03,  3.5741e-02, -9.0296e-01,
         -7.9219e-01, -5.2211e-01, -6.7589e-01, -9.5255e-01,  7.0411e-01,
          2.6826e-01,  4.0883e-02,  5.4808e-01, -2.2253e-01, -2.8980e-01,
         -8.3246e-02,  1.0494e-01, -8.2818e-01,  7.8696e-01, -1.0552e-01,
          2.0068e-01, -1.1545e-01,  2.2196e-01, -8.5198e-01,  8.6098e-01,
          7.5903e-01,  2.5622e-01, -8.8536e-03, -4.7662e-01,  3.9720e-01,
         -3.4306e-01,  8.0380e-01, -7.8320e-02,  8.9613e-01, -1.4736e-01,
         -7.5046e-01,  3.7599e-01,  2.0120e-01,  6.4580e-02,  4.4332e-02,
         -8.3205e-01,  3.1302e-03,  7.8753e-01,  7.9850e-01, -4.4507e-01,
         -5.6260e-03, -3.3181e-02, -5.8860e-01, -7.9499e-01,  4.4164e-01,
         -3.1938e-01, -3.7808e-02,  6.6738e-02,  1.9533e-02,  8.4942e-01,
          5.3235e-03,  9.4798e-02, -1.2333e-01,  8.5869e-02, -1.0280e-01,
         -1.2946e-01,  8.5376e-01,  1.8801e-01, -3.2741e-01, -9.6287e-01,
          6.1638e-01, -6.9420e-01,  4.4450e-01,  6.0681e-01, -6.6629e-01,
          5.0974e-02,  3.4253e-02, -1.8121e-01,  2.2566e-01, -1.4444e-02,
         -1.3434e-01,  4.3035e-02,  1.1194e-01,  9.0154e-01, -2.0848e-01,
         -8.8703e-01, -3.1255e-01,  6.9419e-02, -8.3545e-01, -2.6751e-01,
         -2.3816e-01,  2.7348e-03, -1.5042e-01,  4.7942e-01,  3.3011e-01,
         -1.6503e-01, -9.0385e-01, -6.1607e-02, -1.1797e-01,  9.0846e-01,
          2.6326e-02, -1.3698e-01, -6.5338e-01, -7.4803e-01, -4.6147e-01,
          8.1519e-01, -8.4302e-01,  9.1290e-01, -8.3432e-01,  3.5692e-03,
          7.8573e-01,  2.6059e-01, -7.7205e-01, -3.1327e-03, -6.6097e-02,
          5.1946e-02,  3.9750e-01,  1.4424e-01, -8.5038e-01, -1.8162e-02,
         -1.0716e-02,  1.1313e-01,  8.5687e-04,  3.9124e-01,  4.4546e-01,
          9.0402e-02, -1.6985e-01, -3.3805e-01,  6.1812e-02,  2.2982e-01,
          2.3385e-01, -1.2379e-01,  4.5419e-02,  5.1026e-02, -7.1863e-04,
         -6.6718e-01, -1.3307e-01,  7.8950e-02, -2.0892e-02,  3.0005e-01,
         -9.1189e-01, -6.5355e-01, -7.6801e-01, -9.3507e-02,  5.3021e-01,
          2.1915e-02, -4.8867e-01, -3.5073e-01,  8.0068e-01,  8.4983e-01,
          3.5458e-01,  2.0711e-02,  5.9287e-01, -3.4995e-01, -7.2958e-02,
          3.9693e-02,  7.5798e-02,  6.1057e-01,  4.2597e-01, -2.0743e-02,
          9.1923e-01, -5.0432e-03,  5.8217e-02, -6.0209e-01,  1.3403e-01,
         -7.2889e-02,  6.6255e-01, -4.6876e-01, -8.6120e-01,  1.0894e-02,
          1.8972e-02, -4.4184e-01,  2.5289e-02, -1.1211e-01, -3.0922e-01,
          6.5002e-01,  7.4250e-01,  5.5601e-01, -1.8821e-01,  1.3612e-01,
         -9.7374e-02, -4.0479e-02, -2.4442e-02, -7.8018e-01,  9.5698e-01,
          1.7359e-01,  4.7505e-01,  3.3328e-01,  2.2359e-01,  8.7758e-01,
          1.3941e-02,  3.2011e-01, -1.0929e-02,  7.9241e-01,  6.8530e-02,
         -7.1604e-01,  5.0206e-01, -9.1000e-01, -3.8872e-02, -7.6048e-01,
          1.7364e-01, -1.7590e-01,  5.9545e-01, -1.0509e-01,  8.5677e-01,
          8.0183e-01, -1.7133e-02,  4.1293e-01,  8.1418e-01,  1.5888e-01,
         -7.5477e-01, -9.5126e-01, -9.6628e-01, -7.2032e-02, -2.3228e-01,
          4.7854e-02,  1.7156e-01, -2.8391e-02,  1.4297e-01,  3.4419e-02,
         -8.3534e-01,  7.9761e-01,  1.2672e-01, -8.1043e-01,  8.8525e-01,
         -3.8777e-01,  6.0806e-02,  2.3121e-01, -9.4670e-01, -5.4725e-01,
         -1.0510e-01, -1.3351e-01,  3.5533e-01,  1.4217e-01,  5.4140e-01,
          1.9415e-02, -3.2170e-01, -6.5439e-02,  7.8295e-01, -5.2289e-01,
         -9.5798e-01,  2.8194e-01,  6.3611e-01, -5.6436e-01,  8.3533e-01,
         -6.4246e-01, -1.0839e-01,  7.5424e-01,  7.2921e-01,  5.5158e-01,
          4.3062e-01,  2.0447e-01,  1.1434e-01,  3.8707e-01,  6.9555e-01,
          7.4856e-01,  9.5958e-01,  6.6706e-01,  2.7684e-01,  7.0061e-01,
          2.4441e-02,  4.2779e-01, -8.4437e-01, -5.7102e-02, -4.4115e-01,
          2.1374e-01,  1.0470e-01, -4.6251e-02, -6.4018e-01,  4.0994e-01,
          7.6299e-02,  1.8739e-01, -8.4008e-02,  2.8767e-01, -2.4358e-01,
          1.1020e-02, -5.1402e-01,  4.9222e-02,  2.6653e-01, -5.8301e-02,
          7.9280e-01, -2.4956e-01, -7.8913e-03, -1.1233e-01,  5.1617e-02,
          7.6497e-01, -8.3232e-01,  5.1334e-01,  5.9827e-02,  8.3035e-01,
         -5.8532e-01, -2.4030e-01,  6.1904e-01, -3.5076e-01, -1.3420e-01,
         -8.9157e-02, -4.9536e-01,  4.9910e-01, -4.5500e-02, -1.6105e-01,
         -3.7617e-02,  3.7182e-01,  1.6940e-01, -1.1236e-01,  5.3460e-01,
          7.2991e-01,  1.8875e-01,  4.1904e-02,  1.7980e-01,  6.0190e-02,
         -7.9329e-01,  1.4009e-01,  6.1139e-01, -6.1764e-01,  3.4262e-01,
         -6.7680e-01,  4.8117e-01, -7.8062e-01,  4.0878e-02, -3.7002e-01,
         -6.8798e-01, -3.8813e-01,  1.6272e-01,  1.2418e-01,  7.1285e-01,
         -7.0520e-01,  6.1055e-01,  3.9583e-01,  7.1228e-01,  1.4088e-01,
          5.9301e-01, -3.6854e-01,  5.7186e-01]]))
```

아까와는 다르게 둘의 차이가 없다.

그렇다면 torch.jit.trace()로 변환한 모델에 대해서 torch.jit.save()로 저장을 할 때에는 torch.no_grad() 포함 여부가 어떤 영향을 줄까?
간단한 테스트를 위해서 저장 결과에 대해 각각 sha512sum을 사용해서 체크썸을 계산해보았다.

```bash
$ sha512sum traced_bert.pt
```

실행을 해본 결과, 두 파일의 체크썸 값이 동일하다는 점을 확인할 수 있었다.
즉, torch.jit.save()는 torch.no_grad()와 관련이 없다.

![체크썸 비교](./imgs/jit_checksum_comparison.png)
